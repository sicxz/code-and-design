<!--
  The Story Teller Tutorial - DESN378 Week 1

  An interactive walkthrough for building a digital picture book.
  Teaches: querySelector, arrays, addEventListener, conditionals, loops
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Learn: The Story Teller - DESN378</title>
  <style>
    /* ========================================
       DESN378 Neural Theme + Tutorial Layout
       ======================================== */
    :root {
      --neural-dark: #050816;
      --neural-teal: #01B799;
      --neural-cyan: #22D3EE;
      --neural-violet: #A855F7;
      --bg-primary: #050816;
      --bg-card: #0d1a2d;
      --bg-tertiary: #111d36;
      --text-primary: #E5F3FF;
      --text-secondary: #B8C0CC;
      --text-muted: #8892a4;
      --border-color: rgba(34, 211, 238, 0.2);
      --border-light: rgba(34, 211, 238, 0.12);
      --teal-glow: rgba(1, 183, 153, 0.4);
      --cyan-glow: rgba(34, 211, 238, 0.4);
      --violet-glow: rgba(168, 85, 247, 0.3);
      --success-color: #10b981;
      --warning-color: #f59e0b;
      --font-system: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
      --font-mono: ui-monospace, SFMono-Regular, 'SF Mono', Consolas, 'Liberation Mono', Menlo, monospace;
    }

    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: var(--font-system);
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.7;
      -webkit-font-smoothing: antialiased;
    }

    /* Skip Link */
    .skip-link {
      position: absolute;
      top: -100px;
      left: 0;
      background: var(--neural-teal);
      color: var(--neural-dark);
      padding: 0.5rem 1rem;
      z-index: 1000;
      text-decoration: none;
      font-weight: 600;
    }

    .skip-link:focus {
      top: 0;
    }

    /* ========================================
       Header with Progress Bar
       ======================================== */
    .tutorial-header {
      position: sticky;
      top: 0;
      z-index: 100;
      background: linear-gradient(135deg, rgba(5, 8, 22, 0.98) 0%, rgba(13, 26, 45, 0.98) 100%);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border-color);
      padding: 1rem 2rem;
    }

    .header-content {
      max-width: 1400px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .header-title h1 {
      font-size: 1.5rem;
      color: var(--neural-cyan);
      margin: 0;
    }

    .header-title .subtitle {
      font-size: 0.875rem;
      color: var(--text-muted);
    }

    .badge {
      display: inline-block;
      padding: 4px 12px;
      background: linear-gradient(135deg, rgba(1, 183, 153, 0.2) 0%, rgba(34, 211, 238, 0.2) 100%);
      color: var(--neural-cyan);
      border: 1px solid rgba(34, 211, 238, 0.3);
      border-radius: 20px;
      font-size: 12px;
      font-weight: 500;
      margin-left: 0.75rem;
    }

    .progress-container {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .progress-bar {
      width: 200px;
      height: 8px;
      background: var(--bg-tertiary);
      border-radius: 4px;
      overflow: hidden;
      border: 1px solid var(--border-light);
    }

    .progress-fill {
      width: 0%;
      height: 100%;
      background: linear-gradient(90deg, var(--neural-teal) 0%, var(--neural-cyan) 100%);
      transition: width 0.5s ease;
    }

    .progress-text {
      font-size: 0.875rem;
      color: var(--text-secondary);
      min-width: 90px;
    }

    /* ========================================
       Two-Column Layout (45% / 55% split)
       ======================================== */
    .tutorial-layout {
      display: flex;
      gap: 0;
      max-width: 1800px;
      margin: 0 auto;
      min-height: calc(100vh - 80px);
    }

    .tutorial-content {
      flex: 0 0 45%;
      max-width: 45%;
      padding: 2rem 1.5rem;
      overflow-y: auto;
      height: calc(100vh - 80px);
      border-right: 1px solid var(--border-color);
    }

    .workspace-panel {
      flex: 1;
      position: relative;
      background: var(--bg-card);
    }

    .workspace-sticky {
      position: sticky;
      top: 80px;
      height: calc(100vh - 80px);
      display: flex;
      flex-direction: column;
      padding: 1.5rem;
    }

    .workspace-header {
      padding: 1rem 1.5rem;
      border-bottom: 1px solid var(--border-light);
    }

    .workspace-header h2 {
      font-size: 1rem;
      color: var(--text-primary);
      margin: 0;
    }

    .workspace-iframe {
      flex: 1;
      border: none;
      width: 100%;
    }

    .workspace-actions {
      padding: 1rem 1.5rem;
      border-top: 1px solid var(--border-light);
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
    }

    /* ========================================
       Typography
       ======================================== */
    h2 {
      font-size: 1.5rem;
      margin-top: 0;
      margin-bottom: 1rem;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    h2::before {
      content: '';
      display: inline-block;
      width: 4px;
      height: 1.5rem;
      background: linear-gradient(180deg, var(--neural-teal) 0%, var(--neural-cyan) 100%);
      border-radius: 2px;
    }

    h3 {
      font-size: 1.125rem;
      margin-top: 1.5rem;
      margin-bottom: 0.75rem;
      color: var(--neural-cyan);
    }

    p {
      margin-bottom: 1rem;
      color: var(--text-secondary);
    }

    strong {
      color: var(--text-primary);
    }

    ul, ol {
      margin-left: 1.5rem;
      margin-bottom: 1rem;
    }

    li {
      margin-bottom: 0.5rem;
      color: var(--text-secondary);
    }

    code {
      padding: 2px 8px;
      font-size: 85%;
      background: rgba(1, 183, 153, 0.1);
      border: 1px solid rgba(1, 183, 153, 0.2);
      border-radius: 4px;
      font-family: var(--font-mono);
      color: var(--neural-teal);
    }

    a {
      color: var(--neural-cyan);
      text-decoration: none;
      font-weight: 500;
      transition: all 0.2s;
    }

    a:hover {
      color: var(--neural-teal);
      text-shadow: 0 0 8px var(--teal-glow);
    }

    /* ========================================
       Section Styles
       ======================================== */
    .tutorial-section {
      margin-bottom: 3rem;
      padding-bottom: 2rem;
      border-bottom: 1px solid var(--border-light);
    }

    .tutorial-section:last-child {
      border-bottom: none;
    }

    .section-header {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .section-number {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 36px;
      height: 36px;
      background: linear-gradient(135deg, var(--neural-teal) 0%, var(--neural-cyan) 100%);
      color: var(--neural-dark);
      border-radius: 50%;
      font-weight: 700;
      font-size: 1rem;
      flex-shrink: 0;
    }

    .section-title h2 {
      margin: 0;
    }

    .section-title h2::before {
      display: none;
    }

    .section-title .subtitle {
      font-size: 0.875rem;
      color: var(--text-muted);
      margin-top: 0.25rem;
    }

    /* ========================================
       Cards and Boxes
       ======================================== */
    .card {
      background: var(--bg-card);
      padding: 1.5rem;
      border-radius: 12px;
      border: 1px solid var(--border-light);
      margin-bottom: 1.5rem;
    }

    .card-accent {
      border-left: 3px solid var(--neural-teal);
    }

    .intro-card {
      background: linear-gradient(135deg, rgba(1, 183, 153, 0.1) 0%, rgba(34, 211, 238, 0.1) 100%);
      border: 1px solid rgba(34, 211, 238, 0.2);
    }

    .try-it-box {
      background: rgba(168, 85, 247, 0.1);
      border: 1px solid rgba(168, 85, 247, 0.3);
      border-radius: 8px;
      padding: 1rem 1.25rem;
      margin: 1.5rem 0;
    }

    .try-it-box h4 {
      color: var(--neural-violet);
      font-size: 0.875rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.5rem;
    }

    .try-it-box p {
      margin: 0;
      font-size: 0.9375rem;
    }

    .tip-box {
      background: rgba(1, 183, 153, 0.1);
      border-left: 3px solid var(--neural-teal);
      padding: 1rem 1.25rem;
      border-radius: 0 8px 8px 0;
      margin: 1rem 0;
    }

    .tip-box p {
      margin: 0;
      font-size: 0.9375rem;
    }

    .warning-box {
      background: rgba(245, 158, 11, 0.1);
      border-left: 3px solid var(--warning-color);
      padding: 1rem 1.25rem;
      border-radius: 0 8px 8px 0;
      margin: 1rem 0;
    }

    .warning-box p {
      margin: 0;
      font-size: 0.9375rem;
    }

    /* ========================================
       Code Blocks
       ======================================== */
    .code-block {
      background: #030712;
      border: 1px solid rgba(1, 183, 153, 0.2);
      border-radius: 8px;
      margin: 1rem 0;
      overflow: hidden;
    }

    .code-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem 1rem;
      background: rgba(1, 183, 153, 0.1);
      border-bottom: 1px solid rgba(1, 183, 153, 0.2);
    }

    .code-header span {
      font-size: 0.75rem;
      color: var(--neural-teal);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .copy-btn {
      background: transparent;
      border: 1px solid var(--neural-teal);
      color: var(--neural-teal);
      padding: 0.25rem 0.75rem;
      border-radius: 4px;
      font-size: 0.75rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .copy-btn:hover {
      background: rgba(1, 183, 153, 0.2);
    }

    .code-block pre {
      padding: 1rem 1.25rem;
      margin: 0;
      overflow-x: auto;
    }

    .code-block code {
      background: transparent;
      border: none;
      padding: 0;
      font-size: 0.875rem;
      line-height: 1.6;
      color: var(--text-secondary);
    }

    /* Syntax highlighting */
    .code-block .comment { color: #6b7280; }
    .code-block .keyword { color: var(--neural-violet); }
    .code-block .string { color: #fbbf24; }
    .code-block .function { color: var(--neural-cyan); }
    .code-block .number { color: #f472b6; }

    /* ========================================
       Hints (Details/Summary)
       ======================================== */
    details.hints {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-light);
      border-radius: 8px;
      margin: 1rem 0;
    }

    details.hints summary {
      padding: 0.75rem 1rem;
      cursor: pointer;
      color: var(--warning-color);
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    details.hints summary::before {
      content: '\01F4A1';
    }

    details.hints[open] summary {
      border-bottom: 1px solid var(--border-light);
    }

    details.hints .hint-content {
      padding: 1rem;
    }

    details.hints ul {
      margin-bottom: 0;
    }

    /* ========================================
       Checkpoints
       ======================================== */
    .checkpoint {
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(34, 211, 238, 0.1) 100%);
      border: 1px solid rgba(16, 185, 129, 0.3);
      border-radius: 8px;
      padding: 1rem 1.25rem;
      margin: 1.5rem 0;
    }

    .checkpoint label {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      cursor: pointer;
      color: var(--text-primary);
      font-weight: 500;
    }

    .checkpoint input[type="checkbox"] {
      width: 20px;
      height: 20px;
      margin-top: 2px;
      accent-color: var(--success-color);
      cursor: pointer;
    }

    .checkpoint input[type="checkbox"]:focus-visible {
      outline: 2px solid var(--neural-cyan);
      outline-offset: 2px;
    }

    .checkpoint.completed {
      background: rgba(16, 185, 129, 0.2);
      border-color: var(--success-color);
    }

    /* ========================================
       Reflection Cards (flexbox-tutorial style)
       ======================================== */
    .reflection {
      background: rgba(168, 85, 247, 0.15);
      border: 2px solid rgba(168, 85, 247, 0.4);
      border-radius: 8px;
      padding: 1.5rem;
      margin: 1.5rem 0 2rem;
    }

    .reflection h4 {
      color: var(--neural-violet);
      font-size: 1.125rem;
      font-weight: 600;
      margin-bottom: 0.75rem;
    }

    .reflection p {
      font-size: 0.9375rem;
      font-style: italic;
      margin-bottom: 0.75rem;
      color: var(--text-secondary);
    }

    .reflection-input {
      width: 100%;
      min-height: 100px;
      padding: 0.75rem 1rem;
      background: var(--bg-primary);
      border: 2px solid rgba(168, 85, 247, 0.3);
      border-radius: 6px;
      color: var(--text-primary);
      font-family: var(--font-system);
      font-size: 0.9375rem;
      line-height: 1.6;
      resize: vertical;
      margin-bottom: 0.75rem;
      transition: border-color 0.2s;
    }

    .reflection-input:focus {
      outline: none;
      border-color: var(--neural-violet);
      box-shadow: 0 0 0 3px var(--violet-glow);
    }

    .reflection-input.saved {
      border-color: var(--success-color);
      background: rgba(16, 185, 129, 0.1);
    }

    .reflection-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .save-reflection {
      background: rgba(168, 85, 247, 0.3);
      color: var(--neural-violet);
      border: none;
      padding: 0.625rem 1.25rem;
      border-radius: 6px;
      font-size: 0.9375rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .save-reflection:hover {
      background: rgba(168, 85, 247, 0.5);
      transform: translateY(-1px);
    }

    .save-status {
      font-size: 0.8125rem;
      color: var(--success-color);
    }

    /* ========================================
       Buttons
       ======================================== */
    button {
      background: linear-gradient(135deg, #01B799 0%, #22D3EE 100%);
      color: #050816;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      font-size: 0.9375rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    button:hover {
      box-shadow: 0 0 20px var(--teal-glow), 0 0 40px var(--cyan-glow);
      transform: translateY(-1px);
    }

    button:active {
      transform: translateY(1px);
    }

    button:focus-visible {
      outline: 2px solid var(--neural-cyan);
      outline-offset: 2px;
    }

    .btn-small {
      padding: 0.5rem 1rem;
      font-size: 0.8125rem;
    }

    .btn-secondary {
      background: transparent;
      color: var(--neural-cyan);
      border: 1px solid var(--neural-cyan);
    }

    .btn-secondary:hover {
      background: rgba(34, 211, 238, 0.1);
      box-shadow: 0 0 15px var(--cyan-glow);
    }

    .btn-danger {
      background: transparent;
      color: #ef4444;
      border: 1px solid #ef4444;
    }

    .btn-danger:hover {
      background: rgba(239, 68, 68, 0.1);
      box-shadow: 0 0 15px rgba(239, 68, 68, 0.4);
    }

    /* ========================================
       Toast Notifications
       ======================================== */
    .toast {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      background: var(--bg-card);
      border: 1px solid var(--neural-teal);
      padding: 1rem 1.5rem;
      border-radius: 8px;
      color: var(--text-primary);
      z-index: 1000;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* ========================================
       Footer
       ======================================== */
    .tutorial-footer {
      padding: 1.5rem 2rem;
      border-top: 1px solid var(--border-color);
      color: var(--text-muted);
      font-size: 0.875rem;
      text-align: center;
    }

    /* ========================================
       Responsive
       ======================================== */
    @media (max-width: 1024px) {
      .tutorial-layout {
        flex-direction: column;
      }

      .tutorial-content {
        flex: none;
        max-width: 100%;
        height: auto;
        border-right: none;
        border-bottom: 1px solid var(--border-color);
        padding: 1.5rem 1rem;
      }

      .workspace-panel {
        flex: none;
      }

      .workspace-sticky {
        position: relative;
        top: 0;
        height: 600px;
        padding: 1rem;
      }

      .progress-bar {
        width: 120px;
      }
    }

    @media (max-width: 640px) {
      .tutorial-header {
        padding: 1rem;
      }

      .header-content {
        flex-direction: column;
        align-items: flex-start;
      }

      .tutorial-content {
        padding: 1rem;
      }

      .section-header {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to main content</a>

  <!-- ========================================
       Header with Progress
       ======================================== -->
  <header class="tutorial-header">
    <div class="header-content">
      <div class="header-title">
        <h1>Learn: The Story Teller <span class="badge">Week 1</span></h1>
        <p class="subtitle">Build an interactive picture book with JavaScript</p>
      </div>
      <div class="progress-container">
        <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="Tutorial progress">
          <div class="progress-fill"></div>
        </div>
        <span class="progress-text">0% Complete</span>
      </div>
    </div>
  </header>

  <div class="tutorial-layout">
    <!-- ========================================
         Main Tutorial Content
         ======================================== -->
    <main id="main-content" class="tutorial-content">

      <!-- ========================================
           Section 0: Getting Started
           ======================================== -->
      <section class="tutorial-section" id="section-0" data-section="0">
        <div class="section-header">
          <span class="section-number">0</span>
          <div class="section-title">
            <h2>Getting Started</h2>
            <p class="subtitle">How to use this tutorial</p>
          </div>
        </div>

        <div class="card intro-card">
          <h3>What You're Building</h3>
          <p>A <strong>digital picture book</strong> where clicking an image advances the story. Each click changes the image and updates the caption text. Progress dots light up to show how far the reader has gone.</p>
          <p>By the end, you'll understand the core pattern of interactive design:</p>
          <p style="text-align: center; font-size: 1.125rem; color: var(--neural-cyan);">
            <strong>User Action &rarr; Event Listener &rarr; State Change &rarr; UI Update</strong>
          </p>
        </div>

        <h3>How This Tutorial Works</h3>
        <ul>
          <li><strong>Read each concept</strong> on the left side</li>
          <li><strong>Code along</strong> in the CodePen workspace on the right</li>
          <li><strong>Check the checkpoint</strong> when you understand the concept</li>
          <li><strong>Write a reflection</strong> to solidify your learning</li>
        </ul>

        <div class="tip-box">
          <p><strong>Tip:</strong> Your progress and reflections are saved automatically. If you close this page and come back, you'll pick up where you left off.</p>
        </div>

        <div class="checkpoint" data-checkpoint="0.1">
          <label>
            <input type="checkbox" class="checkpoint-check">
            <span>I've opened the CodePen workspace and I'm ready to code</span>
          </label>
        </div>
      </section>

      <!-- ========================================
           Section 1: The Grappling Hook (querySelector)
           ======================================== -->
      <section class="tutorial-section" id="section-1" data-section="1">
        <div class="section-header">
          <span class="section-number">1</span>
          <div class="section-title">
            <h2>The Grappling Hook</h2>
            <p class="subtitle">Finding elements with document.querySelector</p>
          </div>
        </div>

        <p><strong>The Problem:</strong> JavaScript can't change something it doesn't know exists. Before we can update an image or change text, we need to <em>find</em> those elements on the page.</p>

        <p><strong>The Solution:</strong> <code>document.querySelector()</code> is your grappling hook. It reaches into the page and grabs the element you're looking for.</p>

        <div class="code-block">
          <div class="code-header">
            <span>JavaScript</span>
            <button class="copy-btn" data-target="code-1">Copy</button>
          </div>
          <pre><code id="code-1"><span class="comment">// Find the image element inside .story-image</span>
<span class="keyword">const</span> storyImage = <span class="function">document.querySelector</span>(<span class="string">'.story-image img'</span>);

<span class="comment">// Find the caption paragraph by its ID</span>
<span class="keyword">const</span> caption = <span class="function">document.querySelector</span>(<span class="string">'#story-caption'</span>);

<span class="comment">// Test it - check the console</span>
<span class="function">console.log</span>(<span class="string">'Found image:'</span>, storyImage);
<span class="function">console.log</span>(<span class="string">'Found caption:'</span>, caption);</code></pre>
        </div>

        <h3>The Selector Syntax</h3>
        <p>Inside the parentheses, we use <strong>CSS selector syntax</strong>:</p>
        <ul>
          <li><code>.classname</code> &mdash; finds an element by class</li>
          <li><code>#idname</code> &mdash; finds an element by ID</li>
          <li><code>element</code> &mdash; finds by tag name (like <code>img</code> or <code>p</code>)</li>
          <li><code>.parent child</code> &mdash; finds a child inside a parent</li>
        </ul>

        <div class="try-it-box">
          <h4>Try It</h4>
          <p>In your CodePen, add the two <code>const</code> lines to your JavaScript. Open the console (click "Console" at the bottom of CodePen) to see if the elements were found.</p>
        </div>

        <details class="hints">
          <summary>Show Hints</summary>
          <div class="hint-content">
            <ul>
              <li>If the console shows <code>null</code>, your selector didn't match anything. Double-check the spelling!</li>
              <li>The HTML has <code>class="story-image"</code> (with a hyphen), so use <code>.story-image</code></li>
              <li>The paragraph has <code>id="story-caption"</code>, so use <code>#story-caption</code></li>
            </ul>
          </div>
        </details>

        <div class="checkpoint" data-checkpoint="1.1">
          <label>
            <input type="checkbox" class="checkpoint-check">
            <span>I can use querySelector to find elements by class and ID</span>
          </label>
        </div>

        <div class="checkpoint" data-checkpoint="1.2">
          <label>
            <input type="checkbox" class="checkpoint-check">
            <span>I understand the difference between <code>.class</code> and <code>#id</code> selectors</span>
          </label>
        </div>

        <div class="reflection" data-reflection="1">
          <h4>Reflection</h4>
          <p>In your own words, what is querySelector doing? What happens if it can't find the element you're looking for?</p>
          <textarea class="reflection-input" placeholder="Write your reflection here..." aria-label="Reflection on querySelector"></textarea>
          <div class="reflection-footer">
            <button class="btn-small save-reflection">Save</button>
            <span class="save-status" aria-live="polite"></span>
          </div>
        </div>
      </section>

      <!-- ========================================
           Section 2: The Memory (Variables & Arrays)
           ======================================== -->
      <section class="tutorial-section" id="section-2" data-section="2">
        <div class="section-header">
          <span class="section-number">2</span>
          <div class="section-title">
            <h2>The Memory</h2>
            <p class="subtitle">Variables and Arrays for storing content</p>
          </div>
        </div>

        <p>We need a way to <strong>remember things</strong>: the story text, and which page the reader is on.</p>

        <h3>Variables: Named Storage</h3>
        <p>A variable is like a labeled box where you store a value.</p>
        <ul>
          <li><code>const</code> &mdash; for values that <strong>won't change</strong> (the captions list)</li>
          <li><code>let</code> &mdash; for values that <strong>will change</strong> (the current step)</li>
        </ul>

        <h3>Arrays: Ordered Lists</h3>
        <p>An <strong>array</strong> holds multiple values in order. Perfect for our story captions!</p>

        <div class="code-block">
          <div class="code-header">
            <span>JavaScript</span>
            <button class="copy-btn" data-target="code-2">Copy</button>
          </div>
          <pre><code id="code-2"><span class="comment">// The content - an array of story captions</span>
<span class="keyword">const</span> captions = [
  <span class="string">"Click the image to begin..."</span>,     <span class="comment">// Index 0</span>
  <span class="string">"Chapter 1: The journey starts"</span>,    <span class="comment">// Index 1</span>
  <span class="string">"Chapter 2: An unexpected turn"</span>,    <span class="comment">// Index 2</span>
  <span class="string">"Chapter 3: The challenge"</span>,         <span class="comment">// Index 3</span>
  <span class="string">"Chapter 4: Finding the way"</span>,       <span class="comment">// Index 4</span>
  <span class="string">"Chapter 5: The end"</span>               <span class="comment">// Index 5</span>
];

<span class="comment">// Track which step we're on (starts at 0)</span>
<span class="keyword">let</span> currentStep = <span class="number">0</span>;

<span class="comment">// Test: access items by index</span>
<span class="function">console.log</span>(captions[<span class="number">0</span>]);              <span class="comment">// "Click the image to begin..."</span>
<span class="function">console.log</span>(captions[currentStep]);    <span class="comment">// Same thing!</span>
<span class="function">console.log</span>(captions.length);          <span class="comment">// 6 (total items)</span></code></pre>
        </div>

        <div class="warning-box">
          <p><strong>Important:</strong> Arrays start counting at <code>0</code>, not <code>1</code>. So <code>captions[0]</code> is the first item, <code>captions[1]</code> is the second, and so on.</p>
        </div>

        <div class="try-it-box">
          <h4>Try It</h4>
          <p>Add the <code>captions</code> array and <code>currentStep</code> variable to your CodePen. Use <code>console.log()</code> to test accessing different items.</p>
        </div>

        <details class="hints">
          <summary>Show Hints</summary>
          <div class="hint-content">
            <ul>
              <li>The array uses square brackets <code>[ ]</code> with items separated by commas</li>
              <li>Each string is wrapped in quotes</li>
              <li><code>captions.length</code> tells you how many items are in the array</li>
              <li>Customize the caption text to match your story theme!</li>
            </ul>
          </div>
        </details>

        <div class="checkpoint" data-checkpoint="2.1">
          <label>
            <input type="checkbox" class="checkpoint-check">
            <span>I understand the difference between <code>let</code> and <code>const</code></span>
          </label>
        </div>

        <div class="checkpoint" data-checkpoint="2.2">
          <label>
            <input type="checkbox" class="checkpoint-check">
            <span>I can create an array and access items by index</span>
          </label>
        </div>

        <div class="reflection" data-reflection="2">
          <h4>Reflection</h4>
          <p>Why do you think we store captions in an array instead of writing each one separately in the code? What advantage does this give us?</p>
          <textarea class="reflection-input" placeholder="Write your reflection here..." aria-label="Reflection on arrays"></textarea>
          <div class="reflection-footer">
            <button class="btn-small save-reflection">Save</button>
            <span class="save-status" aria-live="polite"></span>
          </div>
        </div>
      </section>

      <!-- ========================================
           Section 3: The Listener (addEventListener)
           ======================================== -->
      <section class="tutorial-section" id="section-3" data-section="3">
        <div class="section-header">
          <span class="section-number">3</span>
          <div class="section-title">
            <h2>The Listener</h2>
            <p class="subtitle">Responding to user interaction</p>
          </div>
        </div>

        <p>Now for the magic: making something <strong>happen when the user clicks</strong>.</p>

        <p><code>addEventListener</code> attaches a "listener" to an element. It waits silently until the specified event occurs, then runs your code.</p>

        <div class="code-block">
          <div class="code-header">
            <span>JavaScript</span>
            <button class="copy-btn" data-target="code-3">Copy</button>
          </div>
          <pre><code id="code-3"><span class="comment">// Listen for clicks on the image</span>
storyImage.<span class="function">addEventListener</span>(<span class="string">'click'</span>, <span class="keyword">function</span>() {
  <span class="comment">// This code ONLY runs when the image is clicked</span>
  <span class="function">console.log</span>(<span class="string">'Image was clicked!'</span>);

  <span class="comment">// Move to the next step</span>
  currentStep++;  <span class="comment">// Same as: currentStep = currentStep + 1</span>
  <span class="function">console.log</span>(<span class="string">'Now on step:'</span>, currentStep);

  <span class="comment">// Update the caption text</span>
  caption.textContent = captions[currentStep];
});</code></pre>
        </div>

        <h3>Breaking It Down</h3>
        <ul>
          <li><code>storyImage</code> &mdash; the element we're attaching the listener to</li>
          <li><code>'click'</code> &mdash; the event type we're listening for</li>
          <li><code>function() { ... }</code> &mdash; the code that runs when clicked</li>
          <li><code>currentStep++</code> &mdash; adds 1 to the variable (turns the page)</li>
          <li><code>caption.textContent</code> &mdash; changes the text inside the caption element</li>
        </ul>

        <div class="try-it-box">
          <h4>Try It</h4>
          <p>Add the addEventListener code to your CodePen. Click the image a few times and watch the console to see the step number increase. The caption text should update too!</p>
        </div>

        <details class="hints">
          <summary>Show Hints</summary>
          <div class="hint-content">
            <ul>
              <li>Make sure you've already defined <code>storyImage</code>, <code>caption</code>, <code>captions</code>, and <code>currentStep</code> above this code</li>
              <li>The function inside <code>addEventListener</code> is called a "callback" &mdash; it's called back when the event happens</li>
              <li><code>textContent</code> changes the text; <code>innerHTML</code> can also add HTML tags</li>
            </ul>
          </div>
        </details>

        <div class="checkpoint" data-checkpoint="3.1">
          <label>
            <input type="checkbox" class="checkpoint-check">
            <span>I understand that addEventListener code only runs when the event happens</span>
          </label>
        </div>

        <div class="checkpoint" data-checkpoint="3.2">
          <label>
            <input type="checkbox" class="checkpoint-check">
            <span>I can update an element's text using textContent</span>
          </label>
        </div>

        <div class="reflection" data-reflection="3">
          <h4>Reflection</h4>
          <p>The code inside addEventListener only runs when clicked. Why is this pattern useful for interactive design? What would happen if the code ran immediately when the page loaded?</p>
          <textarea class="reflection-input" placeholder="Write your reflection here..." aria-label="Reflection on event listeners"></textarea>
          <div class="reflection-footer">
            <button class="btn-small save-reflection">Save</button>
            <span class="save-status" aria-live="polite"></span>
          </div>
        </div>
      </section>

      <!-- ========================================
           Section 4: The Bouncer (Conditionals)
           ======================================== -->
      <section class="tutorial-section" id="section-4" data-section="4">
        <div class="section-header">
          <span class="section-number">4</span>
          <div class="section-title">
            <h2>The Bouncer</h2>
            <p class="subtitle">Preventing errors with conditionals</p>
          </div>
        </div>

        <p><strong>The Problem:</strong> What happens if the user clicks 10 times, but we only have 6 captions? The code would try to access <code>captions[6]</code>, <code>captions[7]</code>, etc. &mdash; which don't exist!</p>

        <p><strong>The Solution:</strong> An <code>if</code> statement acts like a bouncer, checking if it's safe before letting the code through.</p>

        <div class="code-block">
          <div class="code-header">
            <span>JavaScript</span>
            <button class="copy-btn" data-target="code-4">Copy</button>
          </div>
          <pre><code id="code-4">storyImage.<span class="function">addEventListener</span>(<span class="string">'click'</span>, <span class="keyword">function</span>() {
  <span class="comment">// The Bouncer: check before letting through</span>
  <span class="keyword">if</span> (currentStep < captions.length - <span class="number">1</span>) {
    <span class="comment">// Safe to advance!</span>
    currentStep++;

    <span class="comment">// Update the caption</span>
    caption.textContent = captions[currentStep];

    <span class="comment">// Update the image source</span>
    storyImage.src = <span class="string">`assets/images/image-</span>${currentStep + <span class="number">1</span>}<span class="string">.jpg`</span>;
  }
  <span class="comment">// If we're at the end, nothing happens - the bouncer stops us</span>
});</code></pre>
        </div>

        <h3>How the Check Works</h3>
        <ul>
          <li><code>captions.length</code> &mdash; returns 6 (total items)</li>
          <li><code>captions.length - 1</code> &mdash; returns 5 (the last valid index)</li>
          <li><code>currentStep &lt; 5</code> &mdash; true if we haven't reached the end</li>
        </ul>

        <div class="tip-box">
          <p><strong>About the image source:</strong> The backticks <code>`...`</code> are template literals. They let you insert variables using <code>${...}</code>. So if <code>currentStep</code> is 2, the path becomes <code>assets/images/image-3.jpg</code>.</p>
        </div>

        <div class="try-it-box">
          <h4>Try It</h4>
          <p>Update your addEventListener with the <code>if</code> statement. Click through your story until the end &mdash; it should stop gracefully instead of breaking.</p>
        </div>

        <details class="hints">
          <summary>Show Hints</summary>
          <div class="hint-content">
            <ul>
              <li>In the CodePen, images use Picsum URLs. To update the image, change the random number: <code>storyImage.src = `https://picsum.photos/600/400?random=${currentStep + 1}`</code></li>
              <li>The condition uses <code>&lt;</code> (less than), not <code>&lt;=</code> (less than or equal)</li>
              <li>We use <code>length - 1</code> because the last index is always one less than the length</li>
            </ul>
          </div>
        </details>

        <div class="checkpoint" data-checkpoint="4.1">
          <label>
            <input type="checkbox" class="checkpoint-check">
            <span>I understand why we need to check the array length before advancing</span>
          </label>
        </div>

        <div class="checkpoint" data-checkpoint="4.2">
          <label>
            <input type="checkbox" class="checkpoint-check">
            <span>I can use an if statement to control when code runs</span>
          </label>
        </div>

        <div class="reflection" data-reflection="4">
          <h4>Reflection</h4>
          <p>What would happen to the user experience if we removed the if statement? How does defensive coding like this improve your work?</p>
          <textarea class="reflection-input" placeholder="Write your reflection here..." aria-label="Reflection on conditionals"></textarea>
          <div class="reflection-footer">
            <button class="btn-small save-reflection">Save</button>
            <span class="save-status" aria-live="polite"></span>
          </div>
        </div>
      </section>

      <!-- ========================================
           Section 5: The Assembly Line (forEach)
           ======================================== -->
      <section class="tutorial-section" id="section-5" data-section="5">
        <div class="section-header">
          <span class="section-number">5</span>
          <div class="section-title">
            <h2>The Assembly Line</h2>
            <p class="subtitle">Looping through elements with forEach</p>
          </div>
        </div>

        <p>The progress dots need to light up as the reader advances. We have 5 dots, and we need to update them <strong>all at once</strong>.</p>

        <p><code>forEach</code> is like an assembly line: it goes through each item in a list and does something to it.</p>

        <div class="code-block">
          <div class="code-header">
            <span>JavaScript</span>
            <button class="copy-btn" data-target="code-5">Copy</button>
          </div>
          <pre><code id="code-5"><span class="comment">// Function to update all progress dots</span>
<span class="keyword">function</span> <span class="function">updateProgress</span>(step) {
  <span class="comment">// Get ALL dots (returns a list)</span>
  <span class="keyword">const</span> dots = <span class="function">document.querySelectorAll</span>(<span class="string">'.dot'</span>);

  <span class="comment">// Loop through each dot</span>
  dots.<span class="function">forEach</span>(<span class="keyword">function</span>(dot, index) {
    <span class="comment">// If this dot's index is <= current step, light it up</span>
    <span class="keyword">if</span> (index <= step) {
      dot.classList.<span class="function">add</span>(<span class="string">'active'</span>);
    } <span class="keyword">else</span> {
      dot.classList.<span class="function">remove</span>(<span class="string">'active'</span>);
    }
  });
}

<span class="comment">// Call this inside your click listener:</span>
<span class="comment">// updateProgress(currentStep);</span></code></pre>
        </div>

        <h3>Mental Model: Tracing the Loop</h3>
        <p>Let's say the user is on Step 2. The loop runs 5 times (once per dot):</p>
        <ol>
          <li><strong>Index 0:</strong> Is 0 &lt;= 2? YES &rarr; add 'active' (Dot 1 lit)</li>
          <li><strong>Index 1:</strong> Is 1 &lt;= 2? YES &rarr; add 'active' (Dot 2 lit)</li>
          <li><strong>Index 2:</strong> Is 2 &lt;= 2? YES &rarr; add 'active' (Dot 3 lit)</li>
          <li><strong>Index 3:</strong> Is 3 &lt;= 2? NO &rarr; remove 'active' (Dot 4 dark)</li>
          <li><strong>Index 4:</strong> Is 4 &lt;= 2? NO &rarr; remove 'active' (Dot 5 dark)</li>
        </ol>

        <div class="try-it-box">
          <h4>Try It</h4>
          <p>Add the <code>updateProgress</code> function to your CodePen. Then add <code>updateProgress(currentStep);</code> inside your click listener, after updating the caption. The dots should now light up as you advance!</p>
        </div>

        <details class="hints">
          <summary>Show Hints</summary>
          <div class="hint-content">
            <ul>
              <li><code>querySelectorAll</code> (note the "All") returns multiple elements</li>
              <li><code>forEach</code> gives you two things: the current item (<code>dot</code>) and its position (<code>index</code>)</li>
              <li><code>classList.add()</code> and <code>classList.remove()</code> add/remove CSS classes</li>
              <li>The CSS makes <code>.active</code> dots green</li>
            </ul>
          </div>
        </details>

        <div class="checkpoint" data-checkpoint="5.1">
          <label>
            <input type="checkbox" class="checkpoint-check">
            <span>I understand that forEach automatically goes through each item</span>
          </label>
        </div>

        <div class="checkpoint" data-checkpoint="5.2">
          <label>
            <input type="checkbox" class="checkpoint-check">
            <span>I can use classList.add and classList.remove to change element states</span>
          </label>
        </div>

        <div class="reflection" data-reflection="5">
          <h4>Reflection</h4>
          <p>forEach goes through each item automatically. How is this different from manually writing code for each dot? What would happen if we had 20 dots?</p>
          <textarea class="reflection-input" placeholder="Write your reflection here..." aria-label="Reflection on loops"></textarea>
          <div class="reflection-footer">
            <button class="btn-small save-reflection">Save</button>
            <span class="save-status" aria-live="polite"></span>
          </div>
        </div>
      </section>

      <!-- ========================================
           Section 6: Putting It All Together
           ======================================== -->
      <section class="tutorial-section" id="section-6" data-section="6">
        <div class="section-header">
          <span class="section-number">6</span>
          <div class="section-title">
            <h2>Putting It All Together</h2>
            <p class="subtitle">The complete solution</p>
          </div>
        </div>

        <p>Here's the complete script with all the pieces combined. Compare this to your code &mdash; did you get it working?</p>

        <div class="code-block">
          <div class="code-header">
            <span>JavaScript - Complete</span>
            <button class="copy-btn" data-target="code-6">Copy</button>
          </div>
          <pre><code id="code-6"><span class="comment">// === STEP 1: SELECT ELEMENTS ===</span>
<span class="keyword">const</span> storyImage = <span class="function">document.querySelector</span>(<span class="string">'.story-image img'</span>);
<span class="keyword">const</span> caption = <span class="function">document.querySelector</span>(<span class="string">'#story-caption'</span>);

<span class="comment">// === STEP 2: DEFINE CONTENT ===</span>
<span class="keyword">const</span> captions = [
  <span class="string">"Click the image to begin..."</span>,
  <span class="string">"Chapter 1: The journey starts"</span>,
  <span class="string">"Chapter 2: An unexpected turn"</span>,
  <span class="string">"Chapter 3: The challenge"</span>,
  <span class="string">"Chapter 4: Finding the way"</span>,
  <span class="string">"Chapter 5: The end"</span>
];

<span class="comment">// === STEP 3: TRACK STATE ===</span>
<span class="keyword">let</span> currentStep = <span class="number">0</span>;

<span class="comment">// === STEP 4: LISTEN FOR CLICKS ===</span>
storyImage.<span class="function">addEventListener</span>(<span class="string">'click'</span>, <span class="keyword">function</span>() {
  <span class="comment">// Check if we can advance</span>
  <span class="keyword">if</span> (currentStep < captions.length - <span class="number">1</span>) {
    currentStep++;

    <span class="comment">// Update caption</span>
    caption.textContent = captions[currentStep];

    <span class="comment">// Update image (using Picsum for demo)</span>
    storyImage.src = <span class="string">`https://picsum.photos/600/400?random=</span>${currentStep + <span class="number">1</span>}<span class="string">`</span>;

    <span class="comment">// Update progress dots</span>
    <span class="function">updateProgress</span>(currentStep);
  }
});

<span class="comment">// === STEP 5: HELPER FUNCTION ===</span>
<span class="keyword">function</span> <span class="function">updateProgress</span>(step) {
  <span class="keyword">const</span> dots = <span class="function">document.querySelectorAll</span>(<span class="string">'.dot'</span>);

  dots.<span class="function">forEach</span>(<span class="keyword">function</span>(dot, index) {
    <span class="keyword">if</span> (index <= step) {
      dot.classList.<span class="function">add</span>(<span class="string">'active'</span>);
    } <span class="keyword">else</span> {
      dot.classList.<span class="function">remove</span>(<span class="string">'active'</span>);
    }
  });
}</code></pre>
        </div>

        <h3>Debugging Checklist</h3>
        <p>If your story teller isn't working, check these common issues:</p>
        <ul>
          <li>Is <code>storyImage</code> correctly selecting the <code>&lt;img&gt;</code> element?</li>
          <li>Does your HTML have <code>id="story-caption"</code> on the paragraph?</li>
          <li>Is the <code>if</code> condition preventing infinite clicks?</li>
          <li>Are you calling <code>updateProgress(currentStep)</code> inside the click listener?</li>
          <li>Check the console for error messages!</li>
        </ul>

        <div class="checkpoint" data-checkpoint="6.1">
          <label>
            <input type="checkbox" class="checkpoint-check">
            <span>My Story Teller works! Clicking advances the story and updates the dots.</span>
          </label>
        </div>

        <div class="card card-accent" style="margin-top: 2rem;">
          <h3>What's Next?</h3>
          <p>You've learned the core pattern: <strong>select elements &rarr; store state &rarr; listen for events &rarr; update the UI</strong>.</p>
          <p>For your assignment, customize this with:</p>
          <ul>
            <li>Your own images and story text</li>
            <li>A theme (MLK Day or Valentine's Day)</li>
            <li>Stretch: localStorage to remember progress</li>
          </ul>
          <p>This same pattern powers theme toggles, accordions, carousels, and countless other interactions you'll build in this course.</p>
        </div>

        <div class="reflection" data-reflection="6">
          <h4>Final Reflection</h4>
          <p>Now that you've built a Story Teller, what's one interaction you see on websites that you think uses a similar pattern? How might it work?</p>
          <textarea class="reflection-input" placeholder="Write your reflection here..." aria-label="Final reflection"></textarea>
          <div class="reflection-footer">
            <button class="btn-small save-reflection">Save</button>
            <span class="save-status" aria-live="polite"></span>
          </div>
        </div>
      </section>

      <footer class="tutorial-footer">
        <p><strong>DESN 378: Code + Design</strong> &mdash; Week 1: The Story Teller</p>
        <p>Your progress is saved automatically. <a href="https://developer.mozilla.org/en-US/docs/Learn_web_development/Getting_started/Your_first_website/Adding_interactivity" target="_blank">MDN: Adding Interactivity</a></p>
      </footer>

    </main>

    <!-- ========================================
         Workspace Panel (CodePen)
         ======================================== -->
    <aside class="workspace-panel">
      <div class="workspace-sticky">
        <div class="workspace-header">
          <h2>Your Workspace</h2>
        </div>
        <iframe
          class="workspace-iframe"
          src="https://codepen.io/tmasingale/pen/bNeRoXM?editable=true&utm_source=your_website&utm_medium=embed&utm_campaign=bNeRoXM"
          title="Story Teller CodePen workspace"
          loading="lazy"
          allowfullscreen>
        </iframe>
        <div class="workspace-actions">
          <button class="btn-secondary btn-small" id="copy-reflections">Copy Reflections</button>
          <button class="btn-danger btn-small" id="reset-progress">Reset Progress</button>
        </div>
      </div>
    </aside>

  </div>

  <!-- ========================================
       JavaScript: Tutorial Interactivity
       ======================================== -->
  <script>
    // ==========================================
    // Tutorial State Management
    // ==========================================
    const TutorialState = {
      storageKey: 'storyTellerTutorial',
      totalCheckpoints: 11,
      completedCheckpoints: new Set(),
      reflections: {},

      init() {
        this.loadFromStorage();
      },

      loadFromStorage() {
        try {
          const saved = localStorage.getItem(this.storageKey);
          if (saved) {
            const data = JSON.parse(saved);
            this.completedCheckpoints = new Set(data.checkpoints || []);
            this.reflections = data.reflections || {};
          }
        } catch (e) {
          console.warn('Could not load saved progress:', e);
        }
      },

      saveToStorage() {
        try {
          localStorage.setItem(this.storageKey, JSON.stringify({
            checkpoints: Array.from(this.completedCheckpoints),
            reflections: this.reflections
          }));
        } catch (e) {
          console.warn('Could not save progress:', e);
        }
      },

      reset() {
        this.completedCheckpoints.clear();
        this.reflections = {};
        try {
          localStorage.removeItem(this.storageKey);
        } catch (e) {
          console.warn('Could not clear storage:', e);
        }
      }
    };

    // ==========================================
    // Progress Bar
    // ==========================================
    const Progress = {
      update() {
        const percent = Math.round(
          (TutorialState.completedCheckpoints.size / TutorialState.totalCheckpoints) * 100
        );

        const fill = document.querySelector('.progress-fill');
        const text = document.querySelector('.progress-text');
        const bar = document.querySelector('.progress-bar');

        if (fill) fill.style.width = `${percent}%`;
        if (text) text.textContent = `${percent}% Complete`;
        if (bar) bar.setAttribute('aria-valuenow', percent);
      }
    };

    // ==========================================
    // Checkpoints
    // ==========================================
    const Checkpoints = {
      init() {
        document.querySelectorAll('.checkpoint').forEach(checkpoint => {
          const id = checkpoint.dataset.checkpoint;
          const checkbox = checkpoint.querySelector('.checkpoint-check');

          if (!checkbox || !id) return;

          // Restore state
          checkbox.checked = TutorialState.completedCheckpoints.has(id);
          if (checkbox.checked) {
            checkpoint.classList.add('completed');
          }

          // Listen for changes
          checkbox.addEventListener('change', () => {
            if (checkbox.checked) {
              TutorialState.completedCheckpoints.add(id);
              checkpoint.classList.add('completed');
            } else {
              TutorialState.completedCheckpoints.delete(id);
              checkpoint.classList.remove('completed');
            }
            TutorialState.saveToStorage();
            Progress.update();
          });
        });
      }
    };

    // ==========================================
    // Reflections
    // ==========================================
    const Reflections = {
      init() {
        document.querySelectorAll('.reflection').forEach(reflection => {
          const id = reflection.dataset.reflection;
          const textarea = reflection.querySelector('.reflection-input');
          const saveBtn = reflection.querySelector('.save-reflection');
          const status = reflection.querySelector('.save-status');

          if (!textarea || !id) return;

          // Restore saved text
          if (TutorialState.reflections[id]) {
            textarea.value = TutorialState.reflections[id];
          }

          // Auto-save on typing (debounced)
          let timeout;
          textarea.addEventListener('input', () => {
            clearTimeout(timeout);
            if (status) status.textContent = '';

            timeout = setTimeout(() => {
              TutorialState.reflections[id] = textarea.value;
              TutorialState.saveToStorage();
              if (status) {
                status.textContent = 'Auto-saved';
                setTimeout(() => status.textContent = '', 2000);
              }
            }, 500);
          });

          // Manual save
          if (saveBtn) {
            saveBtn.addEventListener('click', () => {
              TutorialState.reflections[id] = textarea.value;
              TutorialState.saveToStorage();
              if (status) {
                status.textContent = 'Saved!';
                setTimeout(() => status.textContent = '', 2000);
              }
            });
          }
        });
      },

      copyAll() {
        const reflectionTexts = Object.entries(TutorialState.reflections)
          .filter(([_, text]) => text.trim())
          .map(([id, text]) => `/* Reflection ${id} */\n${text}`)
          .join('\n\n');

        if (!reflectionTexts) {
          showToast('No reflections to copy yet!');
          return;
        }

        navigator.clipboard.writeText(reflectionTexts).then(() => {
          showToast('Reflections copied to clipboard!');
        }).catch(() => {
          showToast('Could not copy - try selecting manually');
        });
      }
    };

    // ==========================================
    // Copy Code Buttons
    // ==========================================
    const CopyButtons = {
      init() {
        document.querySelectorAll('.copy-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            const targetId = btn.dataset.target;
            const codeElement = document.getElementById(targetId);

            if (codeElement) {
              const code = codeElement.textContent;
              navigator.clipboard.writeText(code).then(() => {
                const originalText = btn.textContent;
                btn.textContent = 'Copied!';
                setTimeout(() => btn.textContent = originalText, 2000);
              }).catch(() => {
                showToast('Could not copy');
              });
            }
          });
        });
      }
    };

    // ==========================================
    // Toast Notifications
    // ==========================================
    function showToast(message) {
      // Remove existing toast
      const existing = document.querySelector('.toast');
      if (existing) existing.remove();

      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.textContent = message;
      document.body.appendChild(toast);

      setTimeout(() => toast.remove(), 3000);
    }

    // ==========================================
    // Initialize Everything
    // ==========================================
    document.addEventListener('DOMContentLoaded', () => {
      TutorialState.init();
      Checkpoints.init();
      Reflections.init();
      CopyButtons.init();
      Progress.update();

      // Copy reflections button
      const copyBtn = document.getElementById('copy-reflections');
      if (copyBtn) {
        copyBtn.addEventListener('click', () => Reflections.copyAll());
      }

      // Reset progress button
      const resetBtn = document.getElementById('reset-progress');
      if (resetBtn) {
        resetBtn.addEventListener('click', () => {
          if (confirm('Reset all progress and reflections? This cannot be undone.')) {
            TutorialState.reset();
            location.reload();
          }
        });
      }

      // Keyboard shortcut: Ctrl/Cmd+S to save
      document.addEventListener('keydown', (e) => {
        if ((e.ctrlKey || e.metaKey) && e.key === 's') {
          e.preventDefault();
          TutorialState.saveToStorage();
          showToast('Progress saved!');
        }
      });
    });
  </script>
</body>
</html>
